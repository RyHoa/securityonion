import requests
import helpers
from pprint import pprint
import json

# support querying for hash, gimphash, tlsh, ssdeep

def buildReq(observ_type, observ_value):
    if observ_type == 'gimphash':
        qtype = 'get_gimphash'
    elif observ_type == 'tlsh':
        qtype = 'get_tlsh'
    else:
        qtype = 'get_info'
    return {'query': qtype, observ_type: observ_value}

def sendReq(meta, query):
    url = meta['baseUrl']
    response = requests.post(url, query)
    pprint(response.json())
    return response.json()


def prepareResults():
    pass


def initialQuery(querytype, searchtype, data):
    response = requests.post('https://mb-api.abuse.ch/api/v1/', {'query':querytype, searchtype:data})
    rawdata = response.json()
    pprint(rawdata)
    #return response.json()
    
# x = buildReq('hash','7de2c1bf58bce09eecc70476747d88a26163c3d6bb1d85235c24a558d1f16754')
# print(x)
# sendReq(x)

initialQuery('get_info', 'hash', '7de2c1bf58bce09eecc70476747d88a26163c3d6bb1d85235c24a558d1f16754')
#initialQuery('get_tlsh', 'tlsh', '4FB44AC6A19643BBEE8766FF358AC55DBC13D91C1B4DB4FBC789AA020A31B05ED12350')
#initialQuery('get_gimphash', 'gimphash', '50f5783c2188897815d9b34a77aa4df70ac96a71542ddc79b94fef8ce7ba2120')
